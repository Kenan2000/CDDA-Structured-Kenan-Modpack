[
  {
    "id": [
      "TALK_SHELTER",
      "TALK_FRIEND",
      "TALK_FRIEND_GUARD",
      "TALK_STRANGER_AGGRESSIVE",
      "TALK_STRANGER_NEUTRAL",
      "TALK_STRANGER_FRIENDLY",
      "TALK_STRANGER_SCARED",
      "TALK_STRANGER_WARY",
      "TALK_MISSION_DESCRIBE_URGENT"
    ],
    "type": "talk_topic",
    "responses": [
      {
        "text": "[ NPC,THRALL ] Submit!",
        "condition": {
          "and": [
            { "not": "is_by_radio" },
            { "u_has_trait": "MESMER" },
            { "not": { "u_has_trait": "block_psychic" } },
            { "npc_has_trait": "THRALL" },
            { "not": { "npc_has_trait": "UNTHRALL" } },
            { "not": { "npc_has_effect": "hypno_suggest" } },
            { "not": { "npc_has_effect": "block_mesmer" } },
            {
              "not": {
                "npc_has_any_trait": [
                  "MYCCUS",
                  "WILLPOWER",
                  "AWAKENED",
                  "MARLOSS",
                  "THRESH_ALPHA",
                  "THRESH_SLIME",
                  "THRESH_CEPHALOPOD"
                ]
              }
            }
          ]
        },
        "topic": "TALK_MESMER_THRALL"
      },
      {
        "text": "[MESMERISM] Look into my eyes, friend.",
        "condition": {
          "and": [
            { "not": "is_by_radio" },
            { "u_has_trait": "MESMER" },
            { "not": { "u_has_trait": "block_psychic" } },
            { "not": { "npc_has_any_trait": ["THRALL"] } },
            { "not": { "npc_has_any_trait": ["WILLPOWER", "AWAKENED"] } },
            {
              "not": { "npc_has_any_trait": ["MYCCUS", "MARLOSS", "THRESH_ALPHA", "THRESH_SLIME", "THRESH_CEPHALOPOD"] }
            },
            { "not": { "npc_has_effect": "hypno_suggest" } },
            { "not": { "npc_has_effect": "block_mesmer" } }
          ]
        },
        "topic": "TALK_MESMER_TRIALS"
      },
      {
        "text": "[MESMERISM] Look into my eyes, friend.",
        "condition": {
          "and": [
            { "not": "is_by_radio" },
            { "u_has_trait": "MESMER" },
            { "not": { "u_has_trait": "block_psychic" } },
            { "not": "npc_friend" },
            { "npc_has_any_trait": ["MESMER", "AWAKENED"] },
            { "not": { "npc_has_effect": "psychic_duelist" } },
            { "not": { "npc_has_var": "psychic_duelist", "type": "general", "context": "mesmer", "value": "yes" } }
          ]
        },
        "topic": "TALK_MESMER_START_DUEL"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_TRIALS",
    "dynamic_line": "I feel... sleepy... all of a sudden.",
    "responses": [
      { "text": "You were saying something earlier?", "topic": "TALK_NONE" },
      {
        "text": "[vs PER+INT] Your mind is too weak to resist me.",
        "switch": true,
        "topic": "TALK_MESMER_SUCESSS",
        "condition": {
          "and": [
            { "not": { "npc_has_intelligence": 7 } },
            { "not": { "npc_has_perception": 7 } },
            { "u_has_intelligence": 8 },
            { "u_has_perception": 8 }
          ]
        }
      },
      {
        "text": "[vs TRAITS] Your mind is fragile and unbalanced.",
        "topic": "TALK_MESMER_SUCESSS",
        "switch": true,
        "condition": {
          "and": [
            {
              "and": [
                {
                  "npc_has_any_trait": [
                    "CHEMIMBALANCE",
                    "UNOBSERVANT",
                    "SLOWLEARNER",
                    "INSOMNIA",
                    "FORGETFUL",
                    "NARCOLEPTIC",
                    "TRUTHTELLER"
                  ]
                },
                {
                  "npc_has_any_trait": [
                    "PYROMANIA",
                    "PSYCHOPATH",
                    "KILLER",
                    "MASOCHIST",
                    "BADTEMPER",
                    "ADDICTIVE",
                    "SCHIZOPHRENIC",
                    "HOARDER",
                    "MOODSWINGS"
                  ]
                }
              ]
            },
            {
              "not": {
                "npc_has_any_trait": [
                  "FEARLESS",
                  "FASTLEARNER",
                  "GOODMEMORY",
                  "SPIRITUAL",
                  "OPTIMISTIC",
                  "NONADDICTIVE",
                  "SAVANT"
                ]
              }
            }
          ]
        }
      },
      {
        "text": "Yes.  Sleepy.  Very sleepy...",
        "switch": true,
        "condition": "npc_friend",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 40,
          "mod": [
            ["AGGRESSION", -2],
            ["TRUST", 2]
          ]
        },
        "success": { "topic": "TALK_MESMER_SUCCESS" },
        "failure": { "topic": "TALK_MESMER_FAIL" }
      },
      {
        "text": "Your eyes are tired.  Your mind is wrapped in thick fog.",
        "switch": true,
        "default": true,
        "condition": { "not": "npc_friend" },
        "trial": { "type": "PERSUADE", "difficulty": 20, "mod": [["AGGRESSION", -2]] },
        "success": { "topic": "TALK_MESMER_SUCCESS" },
        "failure": { "topic": "TALK_MESMER_FAIL" }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_FAIL",
    "dynamic_line": "Wha!  What was that?  I zoned out for a second.",
    "responses": [
      { "text": "...", "topic": "TALK_DONE", "effect": { "npc_add_effect": "block_mesmer", "duration": 86400 } }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_SUCCESS",
    "dynamic_line": "So tired...",
    "responses": [
      {
        "text": "From henceforth, you will be my psychic thrall, forever bound to my will! (only one attempt per NPC)",
        "condition": { "not": { "npc_has_any_trait": ["THRALL", "UNTHRALL"] } },
        "trial": {
          "type": "PERSUADE",
          "difficulty": 0,
          "mod": [
            ["BRAVERY", -2],
            ["POS_FEAR", -1],
            ["AGGRESSION", -2]
          ]
        },
        "success": {
          "topic": "TALK_DONE",
          "effect": [{ "npc_add_trait": "THRALL" }, { "u_add_effect": "thrall_victory", "duration": 2 }],
          "opinion": { "trust": 5, "fear": 5 }
        },
        "failure": {
          "topic": "TALK_MESMER_FAIL",
          "effect": [{ "npc_add_trait": "UNTHRALL" }],
          "opinion": { "trust": -5, "fear": 3, "anger": 3 }
        }
      },
      {
        "text": "Set down your weapon.  There is no need for violence.",
        "condition": "npc_has_weapon",
        "trial": { "type": "PERSUADE", "difficulty": 50 },
        "success": { "topic": "TALK_DONE", "effect": "drop_weapon", "opinion": { "fear": 3, "anger": -3 } },
        "failure": { "topic": "TALK_MESMER_FAIL", "opinion": { "trust": -1, "fear": 1, "anger": 2 } }
      },
      {
        "text": "We should travel together as companions.  Doesn't that sound like a good idea?  A good idea.",
        "condition": { "not": "npc_following" },
        "trial": { "type": "PERSUADE", "difficulty": 50 },
        "success": { "topic": "TALK_DONE", "effect": "follow", "opinion": { "trust": 1, "fear": 2, "anger": -2 } },
        "failure": { "topic": "TALK_MESMER_FAIL", "opinion": { "trust": -1, "fear": 2, "anger": 1 } }
      },
      {
        "text": "[NPC -ANGER]  Let go of your hostility and relax.  Relax.  Be peaceful and serene.",
        "topic": "TALK_DONE",
        "effect": { "npc_add_effect": "block_mesmer", "duration": 86400 },
        "opinion": { "anger": -15 }
      },
      {
        "text": "[NPC +TRUST]  You must trust me more.  Trust me.  We're the best of friends, you and I.  Friends.",
        "topic": "TALK_DONE",
        "effect": { "npc_add_effect": "block_mesmer", "duration": 86400 },
        "opinion": { "value": 1, "trust": 10 }
      },
      {
        "text": "[NPC -FEAR]  Do not fear for your safety.  Safety.  We're perfectly safe.",
        "topic": "TALK_DONE",
        "effect": { "npc_add_effect": "block_mesmer", "duration": 86400 },
        "opinion": { "fear": -10, "anger": -10 }
      },
      {
        "text": "[NPC +SLEEP]  Yes sleep.  Let the heaviness pull you into a deep slumber.  Sleep.",
        "topic": "TALK_DONE",
        "effect": [
          { "npc_add_effect": "block_mesmer", "duration": 86400 },
          { "npc_add_effect": "sleep", "duration": 28800 },
          { "npc_add_effect": "narcosis", "duration": 28800 }
        ]
      },
      { "text": "You will forget all about this...", "topic": "TALK_DONE" }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_THRALL",
    "dynamic_line": "I hear and obey.",
    "responses": [
      {
        "text": "Purge yourself of weakness and evil, minion!",
        "topic": "TALK_DONE",
        "condition": {
          "npc_has_any_trait": [
            "CHEMIMBALANCE",
            "UNOBSERVANT",
            "SLOWLEARNER",
            "INSOMNIA",
            "DISORGANIZED",
            "FORGETFUL",
            "NARCOLEPTIC",
            "PYROMANIA",
            "CANNIBAL",
            "PSYCHOPATH",
            "KILLER",
            "MASOCHIST",
            "BADTEMPER",
            "ADDICTIVE",
            "SCHIZOPHRENIC",
            "MOODSWINGS",
            "HOARDER"
          ]
        },
        "effect": [
          { "npc_add_effect": "hypno_suggest", "duration": 86400 },
          { "npc_lose_trait": "CHEMIMBALANCE" },
          { "npc_lose_trait": "UNOBSERVANT" },
          { "npc_lose_trait": "SLOWLEARNER" },
          { "npc_lose_trait": "INSOMNIA" },
          { "npc_lose_trait": "DISORGANIZED" },
          { "npc_lose_trait": "FORGETFUL" },
          { "npc_lose_trait": "NARCOLEPTIC" },
          { "npc_lose_trait": "PYROMANIA" },
          { "npc_lose_trait": "CANNIBAL" },
          { "npc_lose_trait": "PSYCHOPATH" },
          { "npc_lose_trait": "KILLER" },
          { "npc_lose_trait": "MASOCHIST" },
          { "npc_lose_trait": "BADTEMPER" },
          { "npc_lose_trait": "ADDICTIVE" },
          { "npc_lose_trait": "SCHIZOPHRENIC" },
          { "npc_lose_trait": "MOODSWINGS" },
          { "npc_lose_trait": "HOARDER" }
        ]
      },
      {
        "text": "Fortify your mind to the horrors of the cosmos.  Many dangers lie ahead.",
        "topic": "TALK_DONE",
        "effect": [
          { "npc_add_effect": "hypno_suggest", "duration": 86400 },
          { "npc_add_effect": "resist_fear", "duration": 86400 },
          { "npc_add_effect": "resist_psychic_feedback", "duration": 86400 },
          { "npc_add_effect": "resist_psychic_stress", "duration": 86400 }
        ]
      },
      {
        "text": "Let go of your pain.",
        "topic": "TALK_DONE",
        "effect": [{ "npc_add_effect": "pkill2", "duration": 3600 }]
      },
      {
        "text": "[NPC +VALUE]  Submit your will to me.",
        "topic": "TALK_DONE",
        "effect": [
          { "npc_add_effect": "hypno_suggest", "duration": 86400 },
          { "npc_lose_effect": "asked_to_follow" },
          { "npc_lose_effect": "asked_to_train" },
          { "npc_lose_effect": "asked_for_item" }
        ],
        "opinion": { "value": 10, "anger": -10, "trust": 10 }
      },
      {
        "text": "Lend me your life-power, mindslave.",
        "topic": "TALK_DONE",
        "condition": { "not": { "npc_has_effect": "thrall_drain" } },
        "effect": [
          { "npc_add_effect": "hypno_suggest", "duration": 86400 },
          { "npc_add_effect": "thrall_drain", "duration": 86400 },
          { "u_add_effect": "thrall_boost", "duration": 43200 }
        ],
        "opinion": { "value": -2, "anger": 3, "trust": -5 }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_START_DUEL",
    "dynamic_line": "You have picked the wrong target, 'friend', for I too am awakened to the powers of the mind.  \nPrepare yourself for battle!",
    "responses": [
      { "text": "Forgive my mistake! I concede...", "topic": "TALK_MESMER_DUEL_CONCEDE" },
      {
        "text": "Another psychic?  So be it.  Let the duel begin!",
        "topic": "TALK_MESMER_DUEL_0c",
        "effect": [
          { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
          { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" }
        ]
      },
      { "text": "How does a duel work?", "topic": "TALK_MESMER_DUEL_RULES" }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_RULES",
    "dynamic_line": "A psychic duel is fought in a series of rounds.  \nEach successful round establishes one 'contact'.  \nThe first to gain three contacts wins.  \nYou can also risk an assault with less than three contacts,  \n but a failed assault results in instant defeat.",
    "responses": [{ "text": "I see...", "topic": "TALK_MESMER_START_DUEL" }]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_0c",
    "dynamic_line": ["<mesmer_0c>"],
    "responses": [
      {
        "switch": true,
        "text": "* DUEL * [0/3]",
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
        "trial": {
          "type": "PERSUADE",
          "difficulty": -20,
          "mod": [
            ["ALTRUISM", 1],
            ["AGRESSION", -1],
            ["ANGER", 1],
            ["BRAVERY", 2],
            ["FEAR", -2]
          ]
        },
        "success": {
          "topic": "TALK_MESMER_DUEL_1c",
          "effect": [{ "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        }
      },
      {
        "switch": true,
        "text": "* DUEL * [0/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": -10,
          "mod": [
            ["ALTRUISM", 2],
            ["AGRESSION", -2],
            ["ANGER", 1],
            ["BRAVERY", -1],
            ["FEAR", 1]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
        "success": {
          "topic": "TALK_MESMER_DUEL_1c",
          "effect": [{ "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [{ "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" }]
        }
      },
      {
        "switch": true,
        "text": "* DUEL * [0/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 0,
          "mod": [
            ["ALTRUISM", -1],
            ["AGRESSION", 2],
            ["ANGER", 2],
            ["BRAVERY", 1],
            ["FEAR", -3]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
        "success": {
          "topic": "TALK_MESMER_DUEL_1c",
          "effect": [{ "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [{ "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }]
        }
      },
      {
        "text": "* CONCEDE *",
        "condition": {
          "not": {
            "or": [
              { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
              { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
              { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
            ]
          }
        },
        "topic": "TALK_MESMER_DUEL_CONCEDE"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_1c",
    "dynamic_line": ["<mesmer_1c>"],
    "responses": [
      {
        "switch": true,
        "text": "* DUEL * [1/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": -10,
          "mod": [
            ["ALTRUISM", -2],
            ["AGRESSION", 2],
            ["ANGER", 1],
            ["BRAVERY", -1],
            ["FEAR", 0]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
        "success": {
          "topic": "TALK_MESMER_DUEL_2c",
          "effect": [{ "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" }]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_DEFEAT",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        }
      },
      {
        "switch": true,
        "text": "* DUEL * [1/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 0,
          "mod": [
            ["ALTRUISM", 1],
            ["AGRESSION", -3],
            ["ANGER", -2],
            ["BRAVERY", 3],
            ["FEAR", -1]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
        "success": {
          "topic": "TALK_MESMER_DUEL_2c",
          "effect": [{ "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" }]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [{ "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" }]
        }
      },
      {
        "switch": true,
        "text": "* DUEL * [1/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 10,
          "mod": [
            ["ALTRUISM", 1],
            ["AGRESSION", -1],
            ["ANGER", 2],
            ["BRAVERY", -2],
            ["FEAR", 2]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
        "success": {
          "topic": "TALK_MESMER_DUEL_2c",
          "effect": [{ "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" }]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [{ "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }]
        }
      },
      {
        "text": "* Final Assault *",
        "trial": { "type": "PERSUADE", "difficulty": -20 },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
        "success": {
          "topic": "TALK_MESMER_DUEL_VICTORY",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_DEFEAT",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_2c",
    "dynamic_line": ["<mesmer_2c>"],
    "responses": [
      {
        "switch": true,
        "text": "* DUEL * [2/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 0,
          "mod": [
            ["ALTRUISM", 3],
            ["AGRESSION", 0],
            ["ANGER", -2],
            ["BRAVERY", -1],
            ["FEAR", 0]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
        "success": {
          "topic": "TALK_MESMER_DUEL_VICTORY",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_DEFEAT",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        }
      },
      {
        "switch": true,
        "text": "* DUEL * [2/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 10,
          "mod": [
            ["ALTRUISM", 0],
            ["AGRESSION", -2],
            ["ANGER", 2],
            ["BRAVERY", 0],
            ["FEAR", 1]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
        "success": {
          "topic": "TALK_MESMER_DUEL_VICTORY",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [{ "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" }]
        }
      },
      {
        "switch": true,
        "text": "* DUEL * [2/3]",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 20,
          "mod": [
            ["NPC_PERSUASION", 1],
            ["AGRESSION", 3],
            ["ANGER", 3],
            ["BRAVERY", 0],
            ["FEAR", -4]
          ]
        },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
        "success": {
          "topic": "TALK_MESMER_DUEL_VICTORY",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [{ "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }]
        }
      },
      {
        "text": "* Final Assault *",
        "trial": { "type": "PERSUADE", "difficulty": -20 },
        "condition": { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
        "success": {
          "topic": "TALK_MESMER_DUEL_VICTORY",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        },
        "failure": {
          "topic": "TALK_MESMER_DUEL_CONTACTED",
          "effect": [
            { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "lost" },
            { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "won" }
          ]
        }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_CONTACTED",
    "dynamic_line": {
      "npc_has_var": "psyduel_contact",
      "type": "general",
      "context": "mesmer",
      "value": "1",
      "no": "You'll never defeat me.  [2/3]",
      "yes": "Ha ha.  Your defenses are crumbling.  [1/3]"
    },
    "responses": [
      {
        "switch": true,
        "text": "It's not over yet.",
        "condition": { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
        "topic": "TALK_MESMER_DUEL_0c"
      },
      {
        "switch": true,
        "text": "Just you wait.",
        "condition": { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
        "topic": "TALK_MESMER_DUEL_1c"
      },
      {
        "switch": true,
        "text": "We'll see about that.",
        "condition": { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
        "topic": "TALK_MESMER_DUEL_2c"
      },
      {
        "text": "[+INSOMNIA] * Absorb your opponent's sleep disorder, permanently, to gain one contact.",
        "condition": {
          "and": [
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "not": { "u_has_trait": "INSOMNIA" } },
            { "npc_has_trait": "INSOMNIA" }
          ]
        },
        "effect": [
          { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
          { "u_add_trait": "INSOMNIA" },
          { "u_lose_trait": "EASYSLEEPER" },
          { "u_lose_trait": "EASYSLEEPER2" }
        ],
        "topic": "TALK_MESMER_DUEL_2c"
      },
      {
        "text": "[-ANIMAL EMPATHY] * Sacrifice your empathic nature, permanently, to remove two of your opponent's contacts.",
        "condition": {
          "and": [
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "u_has_trait": "ANIMALEMPATH" }
          ]
        },
        "effect": [
          { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
          { "u_add_trait": "ANIMALDISCORD" },
          { "u_lose_trait": "ANIMALEMPATH" }
        ],
        "topic": "TALK_MESMER_DUEL_1c"
      },
      {
        "text": "[+SCHIZO +MOODSWINGS] * Damage your mental state, permanently, to remove two of your opponent's contacts.",
        "condition": {
          "and": [
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
            { "not": { "u_has_trait": "SCHIZOPHRENIC" } },
            { "not": { "u_has_trait": "MOODSWINGS" } }
          ]
        },
        "effect": [
          { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
          { "u_add_trait": "SCHIZOPHRENIC" },
          { "u_add_trait": "MOODSWINGS" }
        ],
        "topic": "TALK_MESMER_DUEL_0c"
      },
      {
        "text": "[TERRIFYING vs JITTERY] * Leverage your terrifying nature to gain one contact and remove one of your opponent's.",
        "condition": {
          "and": [
            {
              "not": { "u_has_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer", "value": "true" }
            },
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "u_has_trait": "TERRIFYING" },
            { "npc_has_trait": "JITTERY" }
          ]
        },
        "effect": [
          { "u_add_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer", "value": "true" },
          { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
          { "npc_lose_trait": "JITTERY" },
          { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" }
        ],
        "topic": "TALK_MESMER_DUEL_2c"
      },
      {
        "text": "[vs SQUEAMISH] * Take advantage of your opponent's neurosis to gain one contact.  This will cause you psychic feedback.",
        "condition": {
          "and": [
            {
              "not": { "u_has_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer", "value": "true" }
            },
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
            { "npc_has_trait": "SQUEAMISH" },
            { "not": { "u_has_trait": "SQUEAMISH" } }
          ]
        },
        "effect": [
          { "u_add_effect": "psychic_feedback", "duration": 36 },
          { "u_add_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer", "value": "true" },
          { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }
        ],
        "topic": "TALK_MESMER_DUEL_1c"
      },
      {
        "text": "[SPIRITUAL] * Rely on your spirituality to remove one of your opponent's contacts.  This will also summon dark beings from your subconscious mind.",
        "condition": {
          "and": [
            {
              "not": { "u_has_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer", "value": "true" }
            },
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
            { "u_has_trait": "SPIRITUAL" }
          ]
        },
        "effect": [
          { "mapgen_update": "summon_shadows" },
          { "u_add_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer", "value": "true" },
          { "u_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" }
        ],
        "topic": "TALK_MESMER_DUEL_1c"
      },
      {
        "text": "[+PACIFIST] Destroy your inner hostility, permanently, to remove two of your opponent's contacts.",
        "condition": {
          "and": [
            { "npc_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "2" },
            { "u_has_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "1" },
            { "not": { "u_has_any_trait": ["BADTEMPER", "PACIFIST", "KILLER", "PSYCHOPATH"] } },
            { "not": { "u_has_flag": "CANNIBAL" } }
          ]
        },
        "effect": [
          { "npc_add_var": "psyduel_contact", "type": "general", "context": "mesmer", "value": "0" },
          { "u_add_trait": "SCHIZOPHRENIC" },
          { "u_add_trait": "MOODSWINGS" }
        ],
        "topic": "TALK_MESMER_DUEL_1c"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_VICTORY",
    "dynamic_line": "No!  Defeated?  How can this be?",
    "speaker_effect": [
      {
        "effect": [
          { "u_lose_var": "psyduel_contact", "type": "general", "context": "mesmer" },
          { "u_lose_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer" },
          { "npc_lose_var": "psyduel_contact", "type": "general", "context": "mesmer" },
          { "u_add_effect": "psychic_duel_victory", "duration": 2 }
        ]
      }
    ],
    "responses": [
      {
        "text": "I have proven myself to be the superior mentalist.  \nThere is no need to punish you for your inevitable failure.",
        "topic": "TALK_DONE",
        "opinion": { "fear": -10, "anger": -10, "value": 4, "favor": 1 },
        "effect": [{ "npc_add_var": "psychic_duelist", "type": "general", "context": "mesmer", "value": "yes" }]
      },
      {
        "text": "You have failed.  Now fall into a deep slumber.",
        "topic": "TALK_DONE",
        "opinion": { "fear": 10, "anger": -5, "trust": 1 },
        "effect": [
          { "npc_add_effect": "sleep", "duration": 28800 },
          { "npc_add_effect": "narcosis", "duration": 28800 }
        ]
      },
      {
        "text": "You are too dangerous to let go. \nI will crush your mind and seal your powers.",
        "topic": "TALK_DONE",
        "opinion": { "fear": 50, "anger": 40, "value": -40, "trust": -15 },
        "effect": [
          { "npc_add_effect": "sleep", "duration": 28800 },
          { "npc_add_effect": "narcosis", "duration": 28800 },
          { "npc_add_trait": "LOBOTOMY" },
          { "npc_lose_trait": "AWAKENED" },
          { "npc_lose_trait": "MESMER" },
          { "npc_lose_trait": "PSYCHIC_DEFENSE" },
          { "npc_lose_trait": "PSYCHIC_STRENGTH" },
          { "npc_lose_trait": "PSYCHIC_PROJECT" }
        ]
      },
      { "text": "Those who oppose me...  \n...must DIE!", "topic": "TALK_DONE", "effect": "npc_die" }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_DEFEAT",
    "dynamic_line": "Ha ha!  Pathetic.  You stood no chance against my highly evolved mind.",
    "speaker_effect": [
      {
        "effect": [
          { "u_lose_var": "psyduel_contact", "type": "general", "context": "mesmer" },
          { "u_lose_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer" },
          { "npc_lose_var": "psyduel_contact", "type": "general", "context": "mesmer" },
          { "u_add_effect": "psychic_duel_defeat", "duration": 2 }
        ]
      }
    ],
    "responses": [
      {
        "switch": true,
        "text": "So this is how it ends...",
        "topic": "TALK_DONE",
        "condition": { "npc_has_flag": "CANNIBAL" },
        "effect": [{ "u_add_effect": "psychic_death", "duration": 77760 }]
      },
      {
        "switch": true,
        "text": "What a humiliating defeat.",
        "topic": "TALK_DONE",
        "condition": { "npc_has_trait": "PACIFIST" },
        "effect": [{ "npc_add_effect": "psychic_duelist", "duration": 77760 }]
      },
      {
        "switch": true,
        "text": "Mercy!",
        "trial": {
          "type": "PERSUADE",
          "difficulty": 20,
          "mod": [
            ["ALTRUISM", 3],
            ["AGRESSION", -2],
            ["ANGER", -3]
          ]
        },
        "success": {
          "topic": "TALK_DONE",
          "opinion": { "fear": -10, "value": -20 },
          "effect": [{ "u_add_effect": "psychic_shackles", "duration": 864000 }]
        },
        "failure": {
          "topic": "TALK_DONE",
          "effect": [
            { "u_add_effect": "psychic_shackles", "duration": 864000 },
            { "u_add_effect": "madness", "duration": "PERMANENT" },
            { "u_add_trait": "LOBOTOMY" },
            { "u_lose_trait": "AWAKENED" },
            { "u_lose_trait": "MESMER" },
            { "u_lose_trait": "PSYCHIC_DEFENSE" },
            { "u_lose_trait": "PSYCHIC_STRENGTH" },
            { "u_lose_trait": "PSYCHIC_PROJECT" }
          ]
        }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_DUEL_CONCEDE",
    "dynamic_line": "A wise choice.  There is no doubt your frail mind would be crushed under the weight of my awesome power.",
    "speaker_effect": [
      {
        "effect": [
          { "npc_lose_var": "psyduel_contact", "type": "general", "context": "mesmer" },
          { "u_lose_var": "psyduel_contact", "type": "general", "context": "mesmer" },
          { "u_lose_var": "psyduel_bonus_contact", "type": "general", "context": "mesmer" },
          { "u_add_effect": "psychic_duel_defeat", "duration": 2 },
          { "npc_add_effect": "psychic_duelist", "duration": 77760 }
        ]
      }
    ],
    "responses": [{ "text": "Someday...", "topic": "TALK_DONE", "opinion": { "fear": -5, "value": -5 } }]
  },
  {
    "type": "talk_topic",
    "id": "TALK_TRUE_FOODPERSON",
    "responses": [
      {
        "text": "[MESMERISM] Look into my eyes, friend.",
        "condition": {
          "and": [
            { "not": "is_by_radio" },
            { "u_has_trait": "MESMER" },
            { "not": { "npc_has_trait": "THRALL" } },
            { "not": { "npc_has_any_trait": ["WILLPOWER", "AWAKENED"] } },
            {
              "not": { "npc_has_any_trait": ["MYCCUS", "MARLOSS", "THRESH_ALPHA", "THRESH_SLIME", "THRESH_CEPHALOPOD"] }
            },
            { "not": { "npc_has_effect": "hypno_suggest" } },
            { "not": { "npc_has_effect": "block_mesmer" } }
          ]
        },
        "topic": "TALK_FOODPERSON_MESMER"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_FOODPERSON_MESMER",
    "dynamic_line": "Yes?  They're... uh... very nice.",
    "responses": [
      {
        "text": "Damn!",
        "effect": [{ "npc_add_trait": "UNTHRALL" }, { "npc_add_trait": "WILLPOWER" }, { "npc_add_trait": "FEARLESS" }],
        "topic": "TALK_TRUE_FOODPERSON"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_GUARD",
    "responses": [
      {
        "text": "[MESMERISM] Look into my eyes, friend.",
        "condition": {
          "and": [
            { "not": "is_by_radio" },
            { "u_has_trait": "MESMER" },
            { "not": { "npc_has_trait": "THRALL" } },
            { "not": { "npc_has_any_trait": ["WILLPOWER", "AWAKENED"] } },
            {
              "not": { "npc_has_any_trait": ["MYCCUS", "MARLOSS", "THRESH_ALPHA", "THRESH_SLIME", "THRESH_CEPHALOPOD"] }
            },
            { "not": { "npc_has_effect": "hypno_suggest" } },
            { "not": { "npc_has_effect": "block_mesmer" } }
          ]
        },
        "topic": "TALK_MESMER_GUARD_TRIALS"
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_GUARD_TRIALS",
    "dynamic_line": "I feel... sleepy... all of a sudden.",
    "responses": [
      { "text": "You were saying something earlier?", "topic": "TALK_NONE" },
      {
        "text": "Your eyes are tired.  Your mind is wrapped in thick fog.",
        "switch": true,
        "trial": { "type": "PERSUADE", "difficulty": 30, "mod": [["AGGRESSION", -2]] },
        "success": { "topic": "TALK_MESMER_GUARD_SUCCESS" },
        "failure": { "topic": "TALK_MESMER_FAIL" }
      }
    ]
  },
  {
    "type": "talk_topic",
    "id": "TALK_MESMER_GUARD_SUCCESS",
    "dynamic_line": "So... tired...",
    "responses": [
      { "text": "Awaken.  And forget this ever happened.", "topic": "TALK_DONE" },
      {
        "text": "Yes sleep.  Let the heaviness pull you into a deep slumber.  Sleep!",
        "topic": "TALK_DONE",
        "effect": [
          { "npc_add_effect": "sleep", "duration": 28800 },
          { "npc_add_effect": "narcosis", "duration": 28800 }
        ]
      }
    ]
  },
  {
    "id": "TALK_STOLE_ITEM",
    "type": "talk_topic",
    "responses": [
      {
        "text": "[MESMER]  There is no item.  You must be seeing things.",
        "condition": {
          "and": [
            { "u_has_trait": "MESMER" },
            "u_has_stolen_item",
            { "not": { "npc_has_any_trait": ["WILLPOWER", "MESMER", "AWAKENED"] } },
            {
              "not": { "npc_has_any_trait": ["MYCCUS", "MARLOSS", "THRESH_ALPHA", "THRESH_SLIME", "THRESH_CEPHALOPOD"] }
            },
            { "not": { "npc_has_effect": "hypno_suggest" } },
            { "not": { "npc_has_effect": "block_mesmer" } }
          ]
        },
        "trial": {
          "type": "PERSUADE",
          "difficulty": 40,
          "mod": [
            ["TRUST", 4],
            ["VALUE", 0],
            ["ANGER", -1]
          ]
        },
        "success": {
          "topic": "TALK_MESMER_KEEP_ITEM",
          "effect": { "npc_add_effect": "hypno_suggest", "duration": 3600 }
        },
        "failure": {
          "topic": "TALK_DISALLOW_KEEP_ITEM",
          "opinion": { "trust": -3, "anger": 2 },
          "effect": { "u_faction_rep": -15 }
        }
      }
    ]
  },
  {
    "id": "TALK_MESMER_KEEP_ITEM",
    "type": "talk_topic",
    "dynamic_line": "I must be seeing things.",
    "responses": [{ "text": "...", "effect": "remove_stolen_status", "topic": "TALK_DONE" }]
  }
]

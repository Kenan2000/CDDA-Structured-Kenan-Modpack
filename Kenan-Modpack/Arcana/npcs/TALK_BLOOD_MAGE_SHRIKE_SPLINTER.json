[
  {
    "type": "talk_topic",
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER",
    "dynamic_line": {
      "npc_has_trait": "SHRIKE_MISSION_MARKER",
      "yes": {
        "npc_has_var": "elena_convinced",
        "type": "flag",
        "context": "shrike",
        "value": "yes",
        "yes": "Welcome.  Try not to cause any trouble.",
        "no": {
          "npc_has_var": "elena_failed",
          "type": "flag",
          "context": "shrike",
          "value": "yes",
          "yes": "We've nothing more to discuss.  Leave.",
          "no": {
            "u_has_any_trait": [ "PROF_CLEANSINGFLAME", "PROF_CLEANSINGFLAME2" ],
            "yes": "…hunter.  They wouldn't just send anything less than a fully hunting party.  Why are you here?",
            "no": {
              "u_has_any_trait": [ "PROF_SANGUINE", "THRESH_DRAGONBLOOD" ],
              "yes": "Well, aren't you a pleasant surprise to see?  I'm aware of the hunters scouting out this place, tracking us.  But they let you through.  Why's that, I wonder?",
              "no": "The hunters sent you, didn't they?  Unusual of them.  What angle are they getting at?"
            }
          }
        }
      },
      "no": {
        "u_has_any_trait": [ "PROF_CLEANSINGFLAME", "PROF_CLEANSINGFLAME2" ],
        "yes": [
          "I've nothing to say to you, Hunter.  If you haven't gotten yourself in trouble yet, speak to the huntmaster.",
          "Hmmph.  Where's the rest of you, they usually come a dozen at a time…",
          "You have a lot of nerve intruding here, you know.",
          "Speak to the huntmaster if you've got something to say.",
          "Don't make me regret letting you live long enough to make it past the front door…"
        ],
        "no": [
          "Speak to our leader if you're here for something.",
          "It's not safe to be here, you know.",
          "I'm not in charge here, sorry."
        ]
      }
    },
    "responses": [
      {
        "text": "…lanius.  I'm here for information.",
        "condition": {
          "and": [
            { "npc_has_trait": "SHRIKE_MISSION_MARKER" },
            { "u_has_any_trait": [ "PROF_CLEANSINGFLAME", "PROF_CLEANSINGFLAME2" ] },
            { "not": { "npc_has_var": "elena_convinced", "type": "flag", "context": "shrike", "value": "yes" } },
            { "not": { "npc_has_var": "elena_failed", "type": "flag", "context": "shrike", "value": "yes" } }
          ]
        },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CLEANSINGFLAME"
      },
      {
        "text": "I was asked to bring back any research that would help us.",
        "condition": {
          "and": [
            { "npc_has_trait": "SHRIKE_MISSION_MARKER" },
            { "not": { "npc_has_var": "elena_convinced", "type": "flag", "context": "shrike", "value": "yes" } },
            { "not": { "npc_has_var": "elena_failed", "type": "flag", "context": "shrike", "value": "yes" } }
          ]
        },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_QUERY"
      },
      {
        "text": "Who are you?",
        "condition": {
          "and": [
            { "npc_has_trait": "SHRIKE_MISSION_MARKER" },
            { "not": { "npc_has_var": "elena_failed", "type": "flag", "context": "shrike", "value": "yes" } }
          ]
        },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_WHO"
      },
      {
        "text": "What can you tell me about this place?",
        "condition": {
          "and": [
            { "npc_has_trait": "SHRIKE_MISSION_MARKER" },
            { "not": { "npc_has_var": "elena_failed", "type": "flag", "context": "shrike", "value": "yes" } }
          ]
        },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_WHERE"
      },
      {
        "text": "Do you have anything to trade?",
        "effect": "start_trade",
        "condition": {
          "and": [
            { "npc_has_trait": "SHRIKE_MISSION_MARKER" },
            { "u_has_var": "elena_trade", "type": "flag", "context": "shrike", "value": "yes" },
            { "not": { "npc_has_var": "elena_failed", "type": "flag", "context": "shrike", "value": "yes" } }
          ]
        },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER"
      },
      {
        "text": "[ATTACK] Ecce, sanguinem magum…",
        "condition": { "u_has_any_trait": [ "PROF_CLEANSINGFLAME", "PROF_CLEANSINGFLAME2" ] },
        "effect": [ { "u_faction_rep": -30 }, "insult_combat" ],
        "topic": "TALK_DONE",
        "opinion": { "value": -1 }
      },
      { "text": "I'll just be going…", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CLEANSINGFLAME",
    "type": "talk_topic",
    "dynamic_line": {
      "u_has_trait": "THRESH_DRAGONBLOOD",
      "yes": "I was right.  You are still a hunter.  And yet, you've strayed beyond what is proper for your order.  They still sent you, didn't they?  Explain yourself.",
      "no": {
        "u_has_trait": "THRESH_VEIL",
        "yes": "There's something about you, hunter.  Something anomalous.  You're not just here on behalf of the Cleansing Flame, are you?  What is it you seek?",
        "no": "And what makes you think I would trust your intentions?  Your kinda have destroyed so much, knowledge that could've been used to adapt and survive in these trying times."
      }
    },
    "responses": [
      {
        "text": "I have used what methods I deem necessary.  I am here to ensure our future, not just my own survival.",
        "condition": { "u_has_trait": "THRESH_DRAGONBLOOD" },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_FALLEN"
      },
      {
        "text": "I am more than just a hunter, now.  I understand the importance of working together, using any means necessary, to ensure humanity's survival.  Will you aid us with this?",
        "condition": { "and": [ { "u_has_trait": "THRESH_VEIL" }, { "u_has_effect": "shrike_inquire_denied" } ] },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CEASE",
        "opinion": { "anger": 2 }
      },
      {
        "text": "I am more than just a hunter, now.  I understand the importance of working together, using any means necessary, to ensure humanity's survival.  Will you aid us with this?",
        "condition": { "u_has_trait": "THRESH_VEIL" },
        "trial": { "type": "PERSUADE", "difficulty": 50 },
        "switch": true,
        "success": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CHOSEN", "opinion": { "value": 1 } },
        "failure": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_FAILURE", "opinion": { "value": -1, "fear": -1 } }
      },
      {
        "text": "We have a community that is thriving, making developments to ensure our survival.  If humanity's survival is your focus as well, then we are not enemies.",
        "condition": { "u_has_effect": "shrike_inquire_denied" },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CEASE",
        "opinion": { "anger": 3 }
      },
      {
        "text": "We have a community that is thriving, making developments to ensure our survival.  If humanity's survival is your focus as well, then we are not enemies.",
        "trial": { "type": "PERSUADE", "difficulty": 15 },
        "switch": true,
        "default": true,
        "success": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_SUCCESS", "opinion": { "value": 1 } },
        "failure": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BRASH", "opinion": { "value": -1, "fear": -1 } }
      },
      {
        "text": "If I had any ill intent here, you would already be dead, and I would've simply taken what we're after.  Is that sufficient proof?",
        "trial": { "type": "INTIMIDATE", "difficulty": 30 },
        "success": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_DEFIANT", "opinion": { "value": 1 } },
        "failure": {
          "topic": "TALK_DONE",
          "opinion": { "value": -1, "fear": -1 },
          "effect": [ { "u_faction_rep": -30 }, "insult_combat" ]
        }
      },
      { "text": "Nevermind…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_FALLEN",
    "type": "talk_topic",
    "dynamic_line": "So that is why you seek information from us.  I guess will trust you with this.  The truth is, we seek to preserve and adapt as well.  That is the purpose of a shrike, to use what we have gained for the sake of others.  It's only now, after all this bloodshed, that it seems we can do more than protect the magi with this gift.",
    "responses": [
      { "text": "What are your people doing now, then?", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_DOING" },
      {
        "text": "Perhaps we can work together.  They mainly seek research, but we can potentially come to an agreement.",
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_ALLIANCE"
      }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_DOING",
    "type": "talk_topic",
    "dynamic_line": "Surviving, primarily.  If any others among the Order cause trouble for having left, we will defend ourselves as we see fit.",
    "responses": [
      {
        "text": "Then we don't have to fight.  I can vouch that your research won't be destroyed.",
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_SUCCESS"
      },
      {
        "text": "Perhaps we can work together.  They mainly seek research, but we can potentially come to an agreement.",
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_ALLIANCE"
      }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CEASE",
    "type": "talk_topic",
    "dynamic_line": "You are impatient.  If you continue pressing this issue, we will lose our patience in this matter as well.",
    "responses": [ { "text": "…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" } ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_SUCCESS",
    "type": "talk_topic",
    "dynamic_line": "So be it, then.  I will trust you on this.  Safe's in the back room, I'll let them know to have it open for you.  Take what you need, then be on your way.",
    "speaker_effect": {
      "effect": [
        { "npc_add_var": "elena_convinced", "type": "flag", "context": "shrike", "value": "yes" },
        {
          "mapgen_update": "arcana_shrikes_unlock_safe",
          "om_terrain": "sanguine_holdout_2",
          "om_special": "sanguine_holdout_shrikes"
        }
      ]
    },
    "responses": [
      { "text": "Thank you.  One more thing before I go…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" },
      { "text": "Thank you, and goodbye.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_ALLIANCE",
    "type": "talk_topic",
    "dynamic_line": "Fine then.  Don't disappoint me.  Safe's in the back, I'll have it opened up, get what you need.  I suppose I can also send someone to check things out at the place you're from.  We'll see if this cooperation actually pans out.",
    "speaker_effect": {
      "effect": [
        { "npc_add_var": "elena_convinced", "type": "flag", "context": "shrike", "value": "yes" },
        {
          "mapgen_update": "arcana_shrikes_unlock_safe",
          "om_terrain": "sanguine_holdout_2",
          "om_special": "sanguine_holdout_shrikes"
        },
        { "mapgen_update": "arcana_shrikes_send_ally", "om_terrain": "cf_church_2", "om_special": "cf_rural_church" }
      ]
    },
    "responses": [
      { "text": "Thank you.  One more thing before I go…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" },
      { "text": "Thank you, and goodbye.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CHOSEN",
    "type": "talk_topic",
    "dynamic_line": "Perhaps you're right.  I don't know if we can all truly work together, but we'll see.  I'll send someone to check things out.  In the meantime, I'll have them open the safe that has a copy of our research, it's in the back room there.",
    "speaker_effect": {
      "effect": [
        { "npc_add_var": "elena_convinced", "type": "flag", "context": "shrike", "value": "yes" },
        {
          "mapgen_update": "arcana_shrikes_unlock_safe",
          "om_terrain": "sanguine_holdout_2",
          "om_special": "sanguine_holdout_shrikes"
        }
      ]
    },
    "responses": [
      { "text": "Thank you.  One more thing before I go…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" },
      { "text": "Thank you, and goodbye.", "topic": "TALK_DONE" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_FAILURE",
    "type": "talk_topic",
    "dynamic_line": "I'm afraid I can't do this.  I'll consult with the others and we shall see, but this would be a grave risk to take.",
    "speaker_effect": { "effect": { "u_add_effect": "shrike_inquire_denied", "duration": 10800 } },
    "responses": [ { "text": "…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" } ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BRASH",
    "type": "talk_topic",
    "dynamic_line": "I'm not foolish enough to believe you.  We have our ways.  We will not prey upon others as the Order has before, but we will not concede anything to you.  Leave in peace, while that is still an option.",
    "speaker_effect": { "effect": { "npc_add_var": "elena_failed", "type": "flag", "context": "shrike", "value": "yes" } },
    "responses": [ { "text": "…", "topic": "TALK_DONE" } ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_DEFIANT",
    "type": "talk_topic",
    "dynamic_line": "You've got guts, I'll give you that.  If we were still a part of the Order, they'd be spilled out across the floor by now.  Times have changed, and I suppose we can come to an agreement.",
    "responses": [
      {
        "text": "We don't have to fight.  I can vouch that your research won't be destroyed.",
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_SUCCESS"
      },
      {
        "text": "We can work together.  They mainly seek research, but there's no reason we can't make more of this.",
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_ALLIANCE"
      }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_QUERY",
    "type": "talk_topic",
    "dynamic_line": {
      "u_has_trait": "THRESH_VEIL",
      "yes": "You serve more than these hunters, don't you?  Interesting.  Keeper or not, your alliance with them is a strange thing indeed.",
      "no": {
        "u_has_any_trait": [ "PROF_SANGUINE", "THRESH_DRAGONBLOOD" ],
        "yes": "And you trust that they will not simply burn any information you bring back to them?",
        "no": "That is why they've sent you?  Can you truly trust their intentions?"
      }
    },
    "responses": [
      {
        "text": "Times are changing.  We have to work together, like it or not.  Are you willing to trust me on this?",
        "condition": { "u_has_trait": "PROF_SANGUINE" },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_FALLEN"
      },
      {
        "text": "They're looking for information they can use to improve their chances of survival, same as both of us.",
        "condition": { "u_has_trait": "THRESH_DRAGONBLOOD" },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_FALLEN"
      },
      {
        "text": "We are not enemies.  We can work together, combine our knowledge to survive.",
        "condition": { "and": [ { "u_has_any_trait": [ "PROF_CHALICE", "THRESH_VEIL" ] }, { "u_has_effect": "shrike_inquire_denied" } ] },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CEASE",
        "opinion": { "anger": 1 }
      },
      {
        "text": "We are not enemies.  We can work together, combine our knowledge to survive.",
        "condition": { "u_has_any_trait": [ "PROF_CHALICE", "THRESH_VEIL" ] },
        "trial": { "type": "PERSUADE", "difficulty": 60 },
        "switch": true,
        "success": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CHOSEN", "opinion": { "value": 1 } },
        "failure": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_FAILURE", "opinion": { "value": -1, "fear": -1 } }
      },
      {
        "text": "They have a thriving community, and are working to secure a future for anyone who will work with them.  We can work together.",
        "condition": { "u_has_effect": "shrike_inquire_denied" },
        "switch": true,
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CEASE",
        "opinion": { "anger": 2 }
      },
      {
        "text": "They have a thriving community, and are working to secure a future for anyone who will work with them.  We can work together.",
        "trial": { "type": "PERSUADE", "difficulty": 15 },
        "switch": true,
        "default": true,
        "success": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_ALLIANCE", "opinion": { "value": 1 } },
        "failure": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BASIC_FAILURE", "opinion": { "value": -1, "fear": -1 } }
      },
      {
        "text": "Enough talk.  Just hand it over and there won't be any trouble.",
        "trial": { "type": "INTIMIDATE", "difficulty": 10 },
        "success": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_DEFIANT", "opinion": { "value": 1 } },
        "failure": { "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_BRASH", "opinion": { "value": -1, "fear": -1 } }
      },
      { "text": "Nevermind…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_WHO",
    "type": "talk_topic",
    "dynamic_line": "We are those who hunt the hunters, those who once threatened our order.  Those days are behind us.  For too long have we squandered our power, protecting people who use their gifts for self-destructive purposes.  We prey upon the abominations that stalk this world now, and defend ourselves as we see fit.",
    "responses": [
      {
        "text": "The others seem to be in more conventional equipment.  Why the mantle of shadows?",
        "condition": {
          "and": [
            {
              "or": [
                { "u_has_skill": { "skill": "magic", "level": 7 } },
                {
                  "u_has_any_trait": [ "PROF_CLEANSINGFLAME", "PROF_CLEANSINGFLAME2", "PROF_SANGUINE", "PROF_CHALICE" ]
                },
                { "u_has_intelligence": 9 },
                { "u_has_perception": 9 }
              ]
            },
            { "not": { "u_has_var": "elena_mentioned_mantle", "type": "flag", "context": "shrike", "value": "yes" } }
          ]
        },
        "opinion": { "value": 4, "anger": -2 },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_MANTLE"
      },
      {
        "text": "Then we have no reason to be enemies.  Our goals are aligned.",
        "condition": { "u_has_any_trait": [ "PROF_CLEANSINGFLAME", "PROF_CLEANSINGFLAME2" ] },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_CHOSEN"
      },
      { "text": "I see…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_MANTLE",
    "type": "talk_topic",
    "dynamic_line": "You're observant, I'll give you that.  It was a gift, from one of their priests I suspect is proably dead by now.  A reminder of the days before the Order drove itself into ruin, before they betrayed the Keepers.  That's all I'm willing to speak of such times.  The future is more important now.",
    "speaker_effect": { "effect": { "u_add_var": "elena_mentioned_mantle", "type": "flag", "context": "shrike", "value": "yes" } },
    "responses": [ { "text": "…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" } ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_WHERE",
    "type": "talk_topic",
    "dynamic_line": "An old hideout of sorts, we'd bring supplies and other materials by every so often, arrange for meetings between major sects of the Order, and all that.",
    "responses": [
      {
        "text": "Is there a risk that the magi might find this place?",
        "condition": { "u_has_trait": "PROF_SANGUINE" },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_MAGI"
      },
      { "text": "What's with the items on the shelf?", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_SHELF" },
      { "text": "Oh, okay.", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" }
    ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_MAGI",
    "type": "talk_topic",
    "dynamic_line": "They certainly know, but we've done quite a bit to send a clear message that this hideout is lost to them if they intend to cause trouble.",
    "responses": [ { "text": "…", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" } ]
  },
  {
    "id": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER_SHELF",
    "type": "talk_topic",
    "dynamic_line": "Some items that have been traded around among our old suppliers, and some surplus equipment.  I suppose I could do without it, it's not like we need most of it.  It's going anywhere else, as it is.",
    "responses": [
      {
        "text": "Perhaps we could trade, then?",
        "effect": [ { "u_add_var": "elena_trade", "type": "flag", "context": "shrike", "value": "yes" }, "start_trade" ],
        "condition": { "not": { "u_has_var": "elena_trade", "type": "flag", "context": "shrike", "value": "yes" } },
        "opinion": { "value": 2, "anger": -1, "fear": -1 },
        "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER"
      },
      { "text": "Okay then.", "topic": "TALK_BLOOD_MAGE_SHRIKE_SPLINTER" }
    ]
  }
]
